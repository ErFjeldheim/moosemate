# Generated with GitHub Copilot due to complex code configuration
schemaVersion: 2.2.0
metadata:
  name: moosemate
  version: 1.0.0
  displayName: MooseMate
  description: A multi-module JavaFX application using Java 21 LTS
  tags:
    - Java
    - JavaFX
    - Maven
    - Spring Boot
  projectType: maven
  language: java

components:
  - name: tools
    container:
      image: registry.access.redhat.com/ubi8/openjdk-11:latest
      memoryLimit: 2Gi
      mountSources: true
      endpoints:
        - name: rest-api
          targetPort: 8080
          exposure: public
          protocol: http
      env:
        - name: MAVEN_OPTS
          value: -Xmx1024m

commands:
  - id: build
    exec:
      component: tools
      workingDir: ${PROJECT_SOURCE}/moosemate
      commandLine: mvn clean install
      group:
        kind: build
        isDefault: true
      label: Build project

  - id: test
    exec:
      component: tools
      workingDir: ${PROJECT_SOURCE}/moosemate
      commandLine: mvn clean test
      group:
        kind: test
        isDefault: true
      label: Run tests

  - id: run-rest
    exec:
      component: tools
      workingDir: ${PROJECT_SOURCE}/moosemate/rest
      commandLine: mvn spring-boot:run
      group:
        kind: run
        isDefault: true
      label: Run REST API

  - id: package
    exec:
      component: tools
      workingDir: ${PROJECT_SOURCE}/moosemate
      commandLine: mvn package -DskipTests
      group:
        kind: build
      label: Package without tests

  - id: clean
    exec:
      component: tools
      workingDir: ${PROJECT_SOURCE}/moosemate
      commandLine: mvn clean
      group:
        kind: build
      label: Clean project

  - id: checkstyle
    exec:
      component: tools
      workingDir: ${PROJECT_SOURCE}/moosemate
      commandLine: mvn checkstyle:check
      group:
        kind: test
      label: Run Checkstyle

  - id: spotbugs
    exec:
      component: tools
      workingDir: ${PROJECT_SOURCE}/moosemate
      commandLine: mvn spotbugs:check
      group:
        kind: test
      label: Run SpotBugs

events:
  postStart:
    - build
